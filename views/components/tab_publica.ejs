<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="tab_public.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div id="results-table" style="display: none;">
        <div class="container">
            <!-- Breadcrumb Navigation -->
            <div class="breadcrumb">
                <a href="/mp">Início</a> / Pesquisa
            </div>

            <!-- Last Update -->
            <div class="last-update">
                Última atualização: 28 abr.2023
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <h1>PESQUISA</h1>
                <h2>Contratos</h2>

                <!-- Contador de Resultados -->
                <div class="results-counter">
                    <div id="count-display" class="count-display">
                        <span id="count-number">0</span> contratos encontrados
                    </div>
                </div>

                <!-- Results Table -->
                <div class="results-section">
                    <h3 class="section-title">Informação detalhada</h3>
                    <div class="table-container">
                        <table class="results-table">
                            <thead>
                                <tr>
                                    <th>Objeto do contrato <i class="fas fa-sort"></i></th>
                                    <th>Tipo de procedimento</th>
                                    <th>Adjudicante</th>
                                    <th>Adjudicatário</th>
                                    <th>Preço contratual <i class="fas fa-sort"></i></th>
                                    <th>Data de publicação <i class="fas fa-sort"></i></th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-contract-id="1">
                                    <td>Prestação de serviços de assessoria jurídica relativa ao procedimento de
                                        licenciamento de obras a que corresponde o Processo n.º 21/2020</td>
                                    <td>Ajuste Direto Regime Geral</td>
                                    <td>Município de Elvas</td>
                                    <td>MLA - Maricato, Lima & Associados - Sociedade de Advogados,RL</td>
                                    <td>6.000,00 €</td>
                                    <td>08-04-2025</td>
                                    <td><button class="details-button" aria-label="Ver detalhes" data-contract-id="1"><i
                                                class="fas fa-plus-circle"></i></button>
                                    </td>
                                </tr>
                                <tr data-contract-id="2">
                                    <td>ADENE_CP_003_2025_USTI Aquisição de equipamento informático</td>
                                    <td>Concurso público</td>
                                    <td>ADENE - Agência para a Energia</td>
                                    <td>Digibéria Information Technologies S.A.</td>
                                    <td>150.800,00 €</td>
                                    <td>08-04-2025</td>
                                    <td><button class="details-button" aria-label="Ver detalhes" data-contract-id="2"><i
                                                class="fas fa-plus-circle"></i></button>
                                    </td>
                                </tr>
                                <tr data-contract-id="3">
                                    <td>Aquisição de serviços continuados de manutenção preventiva e corretiva da
                                        Infraestrutura TIC da CIM Viseu Dão Lafões</td>
                                    <td>Ajuste Direto Regime Geral</td>
                                    <td>Comunidade Intermunicipal Viseu Dão Lafões</td>
                                    <td>BPO CONSULTING, UNIPESSOAL LDA</td>
                                    <td>7.500,00 €</td>
                                    <td>08-04-2025</td>
                                    <td><button class="details-button" aria-label="Ver detalhes" data-contract-id="3"><i
                                                class="fas fa-plus-circle"></i></button>
                                    </td>
                                </tr>
                                <tr data-contract-id="4">
                                    <td>ADENE_CP_003_2025_USTI Aquisição de equipamento informático</td>
                                    <td>Concurso público</td>
                                    <td>ADENE - Agência para a Energia</td>
                                    <td>Páginas aos Blocos, Lda.</td>
                                    <td>3.501,45 €</td>
                                    <td>08-04-2025</td>
                                    <td><button class="details-button" aria-label="Ver detalhes" data-contract-id="4"><i
                                                class="fas fa-plus-circle"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>


                <%- include('pagination') %>

            </div>

        </div>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // Elementos do DOM
                const countDisplay = document.getElementById('count-display');
                const countNumber = document.getElementById('count-number');

                // Obter o número de linhas na tabela (excluindo o cabeçalho)
                const tableRows = document.querySelectorAll('.results-table tbody tr');
                const contractCount = tableRows.length;

                // Atualizar o número no contador
                countNumber.textContent = contractCount;

                // Mostrar o contador automaticamente quando a página carregar
                countDisplay.classList.add('visible');

                // Animar a contagem
                animateCount(0, contractCount);

                // Função para animar a contagem
                function animateCount(start, end) {
                    // Resetar o contador para começar do zero
                    countNumber.textContent = start;

                    // Se o contador já estiver visível, não precisamos animar novamente
                    if (start === end) return;

                    // Calcular a duração da animação baseada no número de contratos
                    const duration = Math.min(1500, Math.max(500, end * 100));
                    const increment = end > 100 ? 5 : 1;
                    const steps = Math.ceil(end / increment);
                    const stepDuration = duration / steps;

                    let current = start;

                    // Função para incrementar o contador
                    function step() {
                        current += increment;
                        if (current > end) current = end;

                        countNumber.textContent = current;

                        if (current < end) {
                            setTimeout(step, stepDuration);
                        }
                    }

                    // Iniciar a animação
                    setTimeout(step, stepDuration);
                }
            });
        </script>
</body>

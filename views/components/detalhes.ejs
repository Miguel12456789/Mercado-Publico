<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhe Contrato - Helpdesk</title>
    <link rel="stylesheet" href="detalhes.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <!-- Container principal que fica oculto inicialmente -->
    <div id="main-container" class="container" style="display: none;">
        <!-- Breadcrumb Navigation -->
        <div class="breadcrumb">
            <a href="/base_gov">Início</a> / Detalhes
        </div>

        <!-- Last Update -->
        <div class="last-update">
            Última atualização: <span id="data-atualizacao"></span>
        </div>

        <main class="content-container">
            <!-- Detalhes do Contrato -->
            <div id="contract-details-container">
                <!-- Detalhes do Contrato -->
                <% if (includeDetails && contracts) { %>
                    <% contracts.forEach((contract, index)=> { %>
                        <div class="contract-details" id="details-<%= contract.uniqueId || index %>"
                            style="display: none;">
                            <div class="page-header">
                                <div class="title-section">
                                    <h1 class="main-title">DETALHES</h1>
                                    <h2 class="subtitle">Contrato</h2>
                                </div>
                            </div>

                            <section class="detail-section">
                                <h3 class="section-title">Informação detalhada</h3>

                                <div class="info-card">
                                    <div class="info-table-container">
                                        <table class="info-table">
                                            <tbody>
                                                <tr>
                                                    <th>Data da publicação</th>
                                                    <td>
                                                        <%= contract.dataPublicacao ? new
                                                            Date(contract.dataPublicacao).toLocaleDateString('pt-PT')
                                                            : 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Tipos de contrato</th>
                                                    <td>
                                                        <%= contract.tiposContrato || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>N° do acordo quadro</th>
                                                    <td>
                                                        <%= contract.numeroAcordoQuadro || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Descrição do acordo quadro</th>
                                                    <td>
                                                        <%= contract.descricaoAcordoQuadro || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Tipologia da medida especial</th>
                                                    <td>
                                                        <%= contract.tipologiaMedidaEspecial || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Tipo de procedimento</th>
                                                    <td>
                                                        <%= contract.tipoProcedimento || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Descrição</th>
                                                    <td>
                                                        <%= contract.descricao || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Fundamentação</th>
                                                    <td>
                                                        <%= contract.fundamentacao || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Fundamentação para recurso ao ajuste direto (se aplicável)</th>
                                                    <td>
                                                        <%= contract.fundamentacaoAjusteDireto || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Regime</th>
                                                    <td>
                                                        <%= contract.regime || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Critérios materiais</th>
                                                    <td>
                                                        <%= contract.criteriosMateriais || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Entidades adjudicantes</th>
                                                    <td>
                                                        <%= contract.entidadesAdjudicantes || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Entidades adjudicatárias</th>
                                                    <td>
                                                        <%= contract.entidadesAdjudicatarias || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Objeto do contrato</th>
                                                    <td>
                                                        <%= contract.objetoContrato || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Procedimento centralizado</th>
                                                    <td>
                                                        <%= contract.procedimentoCentralizado || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>CPVs</th>
                                                    <td>
                                                        <%= contract.cpvs || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Data do contrato</th>
                                                    <td>
                                                        <%= contract.dataContrato || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Preço contratual</th>
                                                    <td class="price-value">
                                                        <%= contract.precoContratual || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Prazo de execução</th>
                                                    <td>
                                                        <%= contract.prazoExecucao || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Local de execução</th>
                                                    <td>
                                                        <%= contract.localExecucao || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Entidades concorrentes</th>
                                                    <td>
                                                        <%= contract.entidadesConcorrentes || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Anúncio</th>
                                                    <td>
                                                        <%= contract.anuncio || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Peças do procedimento</th>
                                                    <td>
                                                        <%= contract.pecasProcedimento || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Modificações contratuais</th>
                                                    <td>
                                                        <%= contract.modificacoesContratuais || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Documentos</th>
                                                    <td>
                                                        <%= contract.documentos || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Observações</th>
                                                    <td>
                                                        <%= contract.observacoes || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Critérios ambientais</th>
                                                    <td>
                                                        <%= contract.criteriosAmbientais || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Justificação para não redução a escrito do contrato</th>
                                                    <td>
                                                        <%= contract.justificacaoNaoReducaoEscrito || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Aviso</th>
                                                    <td>
                                                        <%= contract.aviso || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Causa da extinção do contrato</th>
                                                    <td>
                                                        <%= contract.causaExtincaoContrato || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Data do fecho do contrato</th>
                                                    <td>
                                                        <%= contract.dataFechoContrato || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Preço total efetivo</th>
                                                    <td>
                                                        <%= contract.precoTotalEfetivo || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Causas das alterações ao prazo</th>
                                                    <td>
                                                        <%= contract.causasAlteracoesPrazo || 'N/A' %>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>Causas das alterações ao preço</th>
                                                    <td>
                                                        <%= contract.causasAlteracoesPreco || 'N/A' %>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="actions-footer">
                                    <button class="back-button close-details"
                                        data-contract-id="<%= contract.uniqueId || index %>">
                                        <i data-lucide="arrow-left" class="back-icon"></i>
                                        Voltar à pesquisa
                                    </button>
                                </div>
                            </section>
                        </div>
                        <% }); %>
                            <% } %>
            </div>


        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize Lucide icons
            lucide.createIcons();
        });

        // =================== Data Atual =========================
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();

            const spanData = document.getElementById('data-atualizacao');
            if (!spanData) return;

            const hoje = new Date();
            const meses = ['jan.', 'fev.', 'mar.', 'abr.', 'mai.', 'jun.', 'jul.', 'ago.', 'set.', 'out.', 'nov.', 'dez.'];

            spanData.textContent = `${hoje.getDate()} ${meses[hoje.getMonth()]} ${hoje.getFullYear()}`;
        });
    </script>
</body>

</html>